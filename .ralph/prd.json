{
  "project": "astudio",
  "branchName": "ralph/modal-a11y-mapbox",
  "stories": [
    {
      "id": 1,
      "priority": 1,
      "title": "Replace ProEditConfigModal overlay with ModalDialog",
      "description": "File: packages/ui/src/app/chat/compose/ProEditConfigModal/ProEditConfigModal.tsx. Import ModalDialog from packages/ui/src/components/ui/overlays/Modal/Modal.tsx. Replace the manual overlay div and fixed-position container with <ModalDialog isOpen={isOpen} onClose={onClose} title='Pro Edit Settings' maxWidth='720px' className='...'>. Keep existing inner content unchanged.",
      "acceptance": [
        "Component compiles without errors",
        "Modal opens and closes correctly",
        "Focus is trapped inside the modal",
        "Visual layout matches previous design"
      ],
      "passes": true,
      "notes": "Replaced manual overlay div and fixed-position container with ModalDialog. Import added from ../../../components/ui/overlays/Modal/Modal. Preserved existing styling via className and overlayClassName. Lint passes."
    },
    {
      "id": 2,
      "priority": 2,
      "title": "Replace NewProjectModal overlay with ModalDialog",
      "description": "File: packages/ui/src/app/chat/ChatSidebar/modals/NewProjectModal/NewProjectModal.tsx. Import ModalDialog. Replace outer overlay div with <ModalDialog isOpen={isOpen} onClose={onClose} title='New project' description='...'>. Preserve inner card styles as className.",
      "acceptance": [
        "Component compiles without errors",
        "Modal opens and closes correctly",
        "Focus is trapped inside the modal",
        "Overlay click closes modal"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": 3,
      "priority": 3,
      "title": "Replace ProjectSettingsModal overlay with ModalDialog",
      "description": "File: packages/ui/src/app/chat/ChatSidebar/modals/ProjectSettingsModal/ProjectSettingsModal.tsx. Import ModalDialog. Replace outer overlay div with <ModalDialog isOpen={isOpen} onClose={onClose} title='Project settings'>.",
      "acceptance": [
        "Component compiles without errors",
        "Modal opens and closes correctly",
        "Focus is trapped inside the modal",
        "Escape key closes modal"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": 4,
      "priority": 4,
      "title": "Add Mapbox token guard and remove hardcoded fallback",
      "description": "File: packages/widgets/src/widgets/pizzaz/pizzaz-map/main.tsx. Find the hardcoded Mapbox token fallback. Replace with: const token = import.meta.env.VITE_MAPBOX_TOKEN; if (!token) return <div className='text-red-500'>VITE_MAPBOX_TOKEN is required</div>; mapboxgl.accessToken = token;",
      "acceptance": [
        "Widget shows inline error when token is missing",
        "Mapbox does not initialize without token",
        "No token values leaked in logs or UI",
        "Widget loads normally when token is present"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": 5,
      "priority": 5,
      "title": "Validate accessibility and run lint",
      "description": "Manual checks: Test each modal - Tab should cycle within modal, Escape should close, focus should return to trigger. Run: pnpm lint",
      "acceptance": [
        "All modals trap focus correctly",
        "Escape key closes all modals",
        "Focus returns to triggering element on close",
        "pnpm lint passes without errors",
        "No visual regressions observed"
      ],
      "passes": false,
      "notes": ""
    }
  ]
}
